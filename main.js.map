{"version":3,"sources":["./app/app.tsx","./main.tsx"],"names":["lastImageId","undefined","token","App","startVideo","msgSpan","document","getElementById","stream","navigator","mediaDevices","getUserMedia","video","audio","srcObject","play","console","log","innerText","e","takeScreenshot","canvas","createElement","width","height","getContext","drawImage","data","toDataURL","headers","Authorization","result","axios","post","imageId","loadImage","get","img","setAttribute","objectUrl","enumerateDevices","devicesP","devices","map","device","kind","deviceId","s","slice","join","getGeoLocation","location","geolocation","getCurrentPosition","position","timestamp","coords","latitude","longitude","error","message","background","color","window","Android","showToast","pickPicture","margin","updatePicture","theCallback","image","callbacks","ReactDOM"],"mappings":"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","file":"main.js","sourcesContent":["import axios, { AxiosRequestConfig } from \"axios\";\n\nlet lastImageId: string | undefined = undefined;\n\nconst token = \"eyJ4LWVudiI6IlZBTCIsImFsZyI6IlJTMjU2IiwieC1yZWciOiJFVSIsImtpZCI6InJldS12YWxpZGF0aW9uIn0.eyJmZ3JwIjpbXSwiY2x0eSI6InB1YmxpYyIsInN1YiI6ImE2MWM4MzlhLWEyOGMtNDU3OS04OWM5LTRmZDM2Njg3YmZiYyIsImF1ZCI6Ijk2ODVEMzU3NTAxM0ZFNEYwQUY0NkIxNDE1NDlFQ0E1MDI5NTRGMjRGQjZFRTA5NTZENTAwRkU3QzVGRTE2MzgiLCJhenAiOiI5Njg1RDM1NzUwMTNGRTRGMEFGNDZCMTQxNTQ5RUNBNTAyOTU0RjI0RkI2RUUwOTU2RDUwMEZFN0M1RkUxNjM4Iiwic2NvcGUiOlsiUmVhZEFjY291bnQiLCJTZXR0aW5ncyIsIklkZW50aWZ5QXBwbGlhbmNlIiwiQ29udHJvbCIsIkRlbGV0ZUFwcGxpYW5jZSIsIldyaXRlQXBwbGlhbmNlIiwiUmVhZE9yaWdBcGkiLCJNb25pdG9yIiwiV3JpdGVPcmlnQXBpIiwiSW1hZ2VzIl0sImlzcyI6IkVVOlZBTDoyIiwicHJtIjpbInRyZyIsImRlbW8iLCJhbSIsImVxdCJdLCJleHAiOjE2MzM0MTk5NDgsImlhdCI6MTYzMzMzMzU0OCwianRpIjoiZjFlY2Q1ZjktOGMxNi00ZjhlLWI1MmEtZTAyOTJiOWNhM2QyIn0.LIxIsOGiC2k0HTuvt4FUsu_0EX_-Rgo3PNygmFe1WlQzcu8aSrLk7hsi06xsqxRAwBvet3EGvKN3c2fF8JvGzwcSWaImc9mGaGhDohMpyd3_MlLvXjcCJY06myfd2DvUTlPfs6OvZLhD--RorJOcG0SRsErA04QJ-up_L2ObKF_cFvpbU89WyRilAqMqp6wxmVp_gsosinRCVfMoEl8lhq2PcAni7-XayCpBp3iAYXWp4hVIUbVa-mmOsjWBwUpLts4po0tNsgc4nlWaPMygVrXBgMT6OlVB7v7JARduM-6ZukOFbi76L-71yINpLzz69SsZZMN-IQCxODaTXQlGSg\"\n\nexport function App() {\n  const startVideo = async () => {\n    const msgSpan = document.getElementById(\"msg\");\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: false })\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const video = document.getElementById('video') as any;\n      video.srcObject = stream;\n      video.play();\n      console.log('getUserMedia succeeded');\n      if (msgSpan) msgSpan.innerText = `getUserMedia succeeded`;\n    } catch (e) {\n      if (msgSpan) msgSpan.innerText = `${e}`;\n      console.log(`getUserMedia failed: ${e}`);\n    }\n  };\n\n  const takeScreenshot = async () => {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const video = document.getElementById('video') as any;\n    const canvas = document.createElement('canvas');\n    canvas.width = 1000;\n    canvas.height = 1000;\n    canvas.getContext('2d')?.drawImage(video, 0, 0, 1000, 1000);\n    const data = canvas.toDataURL('image/png');\n\n    console.log(data);\n\n    const headers = {\n      Authorization: `Bearer ${token}`\n    };\n\n    const result = await axios.post('http://10.0.2.2:8080/api/image', { data }, { headers });\n    console.log(result);\n    lastImageId = result.data.imageId;\n  };\n\n  const loadImage = async () => {\n    if (lastImageId === undefined) {\n      return;\n    }\n\n    const result = await axios.get(`http://10.0.2.2:8080/api/image/${lastImageId}?v=gray`);\n    console.log(result);\n\n    const img = document.getElementById('theImg');\n    img?.setAttribute('src', result.data.objectUrl);\n  };\n\n  const enumerateDevices = async () => {\n    const devicesP = document.getElementById('devices');\n    const devices = await navigator.mediaDevices.enumerateDevices();\n    if (devicesP) devicesP.innerText = devices.map(device => `${device.kind}-${device.deviceId}`).map(s => s.slice(0, 30)).join('\\n');\n  };\n\n  const getGeoLocation = async () => {\n    const location = document.getElementById('location');\n    console.log('getGeoLocation', location);\n    if (location) {\n      navigator.geolocation.getCurrentPosition((position) => {\n        console.log('callback: positive');\n        location.innerText = `Position: ${position.timestamp} (${position.coords.latitude}, ${position.coords.longitude})`;\n      }, (error) => {\n        location.innerText = `Error: ${error.message}`;\n      });\n    }\n  };\n\n  return (\n    <>\n      <p>Great web design since 1997</p>\n      <input type='button' value='Enumerate devices'  style={{background: 'brown', color: 'magenta'}} onClick={enumerateDevices} /><br />\n      <input type='button' value='Request permissions'  style={{background: 'yellow', color: 'pink'}} onClick={() =>\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (window as any).Android.showToast(\"Prost!\")} /><br />\n      <input type='button' value='Go to settings'  style={{background: 'green', color: 'yellow'}} onClick={() =>\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (window as any).Android.pickPicture()} /><br />\n      <input type='button' value='Start Video' onClick={startVideo} style={{background: 'blue', color: 'red'}} />\n      {/* <input type='button' value='Capture Image' onClick={takeScreenshot} />\n      <input type='button' value='Load Image form S3' onClick={loadImage} /> */}\n      <p>\n        <video id=\"video\" width='200px' height='200px' style={{margin: 'auto'}}>Video stream not available.</video>\n      </p>\n      {/* <input capture='camera' type='file' accept='image/*' />\n      <input type='file' accept='image/*' /> */}\n      <p>Devices:</p>\n      <p id=\"devices\"></p>\n      <p>State:</p>\n      <p id=\"msg\"></p>\n      <input type='button' value='Get location'  style={{background: 'olive', color: 'white'}} onClick={getGeoLocation} />\n      <p>Location:</p>\n      <p id=\"location\"></p>\n      <input type='button' value='Take Picture' onClick={() =>\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (window as any).Android.updatePicture()} />\n      <img id=\"theImg\" alt=\"alt\" width='400px' height='400px' />\n    </>\n  );\n}\n\nexport function theCallback(image: string) {\n  const img = document.getElementById('theImg');\n  img?.setAttribute('src',`data:image/jpg;base64,${image}`)\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\n(window as any).callbacks = {};\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\n(window as any).callbacks['theCallback'] = theCallback;\n\nexport default App;\n","import { StrictMode } from 'react';\nimport * as ReactDOM from 'react-dom';\n\nimport App from './app/app';\n\nReactDOM.render(\n  <StrictMode>\n    <App />\n  </StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":"webpack:///"}